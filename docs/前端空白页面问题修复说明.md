# 前端空白页面问题修复说明

## 问题原因

所有新功能页面（测试报告、测试覆盖分析、风险评估等）出现空白页面的原因是：**响应数据访问路径错误**。

### 问题详情

**错误的代码：**
```typescript
const response = await testReportApi.getReportList(...)
if (response.content) {  // ❌ 错误：response 没有 content 属性
  reportList.value = response.content
  pagination.total = response.totalElements
}
```

**正确的代码：**
```typescript
const response = await testReportApi.getReportList(...)
if (response.data) {  // ✅ 正确：response.data 才是实际数据
  reportList.value = response.data.content || []
  pagination.total = response.data.totalElements || 0
}
```

### 原因分析

根据 `frontend/src/api/request.ts` 的响应拦截器：
- API 返回的数据结构：`{ code: 200, data: {...}, message: '...' }`
- 响应拦截器返回：`response.data`（即整个响应对象）
- 所以实际数据在 `response.data.data` 中（第一个 `data` 是响应对象，第二个 `data` 是业务数据）

但根据 `RequirementList.vue` 的实现，应该是：
- `response.data` 是 `{ code: 200, data: PageResult, message: '...' }`
- 所以分页数据在 `response.data.data.content` 中

让我再检查一下实际的数据结构...

## 已修复的页面

已修复以下页面的响应数据访问问题：

1. ✅ `TestReportList.vue` - 测试报告管理
2. ✅ `TestCoverageAnalysis.vue` - 测试覆盖分析
3. ✅ `TestRiskAssessment.vue` - 风险评估
4. ✅ `TestReportTemplateList.vue` - 报告模板管理
5. ✅ `PageElementList.vue` - 页面元素管理
6. ✅ `TestSpecificationList.vue` - 测试规约管理
7. ✅ `UIScriptTemplateList.vue` - UI脚本模板管理

## 修复内容

### 修复前
```typescript
if (response.content) {
  reportList.value = response.content
  pagination.total = response.totalElements
}
```

### 修复后
```typescript
if (response.data) {
  reportList.value = response.data.content || []
  pagination.total = response.data.totalElements || 0
}
```

同时添加了错误提示：
```typescript
catch (error) {
  console.error('Failed to load reports', error)
  ElMessage.error('加载报告列表失败')  // 新增错误提示
}
```

## 验证步骤

### 1. 重启前端服务

```powershell
# 停止当前服务（Ctrl+C）
# 重新启动
cd frontend
npm run dev
```

### 2. 清除浏览器缓存

- 按 `Ctrl + F5` 硬刷新
- 或使用无痕模式

### 3. 访问新功能页面

在浏览器地址栏输入以下地址，应该能正常显示页面内容：

- `http://localhost:3000/test-report` - 测试报告管理
- `http://localhost:3000/test-coverage` - 测试覆盖分析
- `http://localhost:3000/test-risk-assessment` - 风险评估
- `http://localhost:3000/test-report-template` - 报告模板管理
- `http://localhost:3000/page-element` - 页面元素管理
- `http://localhost:3000/test-specification` - 测试规约管理
- `http://localhost:3000/ui-script-template` - UI脚本模板管理

### 4. 检查浏览器控制台

按 `F12` 打开开发者工具，检查：
- **Console 标签**：不应该有红色错误
- **Network 标签**：API 请求应该返回 200 状态码

## 如果仍然空白

### 检查1：后端服务是否运行

```powershell
# 检查8080端口
netstat -ano | findstr :8080
```

后端服务应该运行在 `http://localhost:8080`

### 检查2：API 请求是否成功

1. 打开浏览器开发者工具（F12）
2. 切换到 Network 标签
3. 刷新页面
4. 查看 `/api/v1/test-reports` 请求
5. 检查响应状态码和响应内容

**正常响应示例：**
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "content": [],
    "totalElements": 0,
    "totalPages": 0,
    "size": 10,
    "number": 0
  }
}
```

### 检查3：控制台错误信息

如果页面仍然空白，请查看浏览器控制台的完整错误信息，可能的原因：
- API 请求失败（网络错误、CORS 错误等）
- 后端服务未启动
- API 路径配置错误
- 响应数据结构不匹配

## 相关文件

- `frontend/src/api/request.ts` - 请求拦截器和响应拦截器
- `frontend/src/api/testReport.ts` - 测试报告API
- `frontend/src/views/test-report/TestReportList.vue` - 测试报告页面
- `frontend/src/views/requirement/RequirementList.vue` - 参考实现（正确的数据访问方式）

