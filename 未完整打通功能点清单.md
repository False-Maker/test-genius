# 测试设计助手系统 - 未完整打通功能点清单

## 一、API路径不一致问题

## 一、API路径不一致问题（P0 - 必须修复）

### 1. 测试执行记录查询接口路径不匹配
- **前端调用**: `/v1/test-execution/records/task/${taskId}` (testExecution.ts:188)
- **后端实现**: `/v1/test-execution/tasks/{taskId}/records` (TestExecutionController.java:158)
- **问题**: 前端API路径与后端不匹配，会导致404错误
- **影响**: 无法通过任务ID查询执行记录列表

### 2. 用例生成批量接口路径不匹配
- **前端调用**: `/v1/case-generation/batch` (caseGeneration.ts:39)
- **后端实现**: `/v1/case-generation/batch-generate` (CaseGenerationController.java:39)
- **问题**: 前端API路径与后端不匹配
- **影响**: 批量生成用例功能无法使用

### 3. UI脚本生成接口路径不匹配
- **前端调用**: `/v1/ui-script/generate` (uiScriptGeneration.ts:50)
- **后端实现**: `/api/v1/ui-script/generate` (UIScriptGenerationController.java:31)
- **问题**: 前端缺少 `/api` 前缀
- **影响**: UI脚本生成功能无法正常调用

### 4. UI脚本生成任务状态查询路径不匹配
- **前端调用**: `/v1/ui-script/tasks/${taskCode}` (uiScriptGeneration.ts:55)
- **后端实现**: `/api/v1/ui-script/tasks/{taskCode}` (UIScriptGenerationController.java:42)
- **问题**: 前端缺少 `/api` 前缀
- **影响**: 无法查询UI脚本生成任务状态

### 5. UI脚本页面解析接口路径不匹配
- **前端调用**: `/v1/ui-script/parse-page` (uiScriptGeneration.ts:60)
- **后端实现**: `/api/v1/ui-script/parse-page` (UIScriptGenerationController.java:49)
- **问题**: 前端缺少 `/api` 前缀，且请求方式可能不匹配（前端使用POST但传参方式可能不对）
- **影响**: 页面解析功能无法正常使用

## 二、API路径前缀不一致问题

### 6. 后端Controller路径前缀不统一
- **问题**: 
  - 前端request.ts中baseURL已设置为 `/api`，所以前端调用 `/v1/xxx` 实际请求 `/api/v1/xxx`
  - 但后端Controller路径前缀不统一：
    - 部分使用 `/api/v1/xxx`（如：UIScriptGenerationController, FlowDocumentController, DataDocumentController, SpecificationCheckController）
    - 部分使用 `/v1/xxx`（如：TestCaseController, RequirementController, TestExecutionController等）
- **影响**: 
  - 使用 `/api/v1/` 前缀的Controller，前端调用会变成 `/api/api/v1/xxx`（重复）
  - 使用 `/v1/` 前缀的Controller，前端调用正确为 `/api/v1/xxx`
- **建议**: 
  - 统一后端Controller路径前缀为 `/v1/xxx`（去掉 `/api` 前缀）
  - 或者统一为 `/api/v1/xxx`，但前端baseURL改为空字符串

## 三、Service层未实现功能（TODO标记）

### 1. 规约检查功能 - 根据ID列表查询规约
- **位置**: SpecificationCheckController.java:63, 90, 114
- **问题**: 代码中有TODO标记，缺少根据ID列表查询规约的方法
- **影响**: 规约检查功能中，如果指定了规约ID列表，无法正确查询规约
- **代码片段**:
```java
// TODO: 需要添加根据ID列表查询规约的方法
specifications = new ArrayList<>();
```

### 2. 流程文档生成 - 文件导出功能
- **位置**: FlowDocumentGenerationServiceImpl.java:115, 128
- **问题**: 场景图和路径图的文件导出逻辑未实现
- **影响**: 无法导出场景图和路径图为文件
- **代码片段**:
```java
// TODO: 实现文件导出逻辑
```

### 3. 数据文档生成 - AI提取参数和等价类
- **位置**: DataDocumentGenerationServiceImpl.java:454
- **问题**: 从用例中提取参数和等价类时，AI/NLP技术未实现
- **影响**: 等价类表生成功能可能不够智能
- **代码片段**:
```java
// TODO: 使用AI或NLP技术从用例中提取参数和等价类
```

### 4. 测试报告模板 - 删除前检查
- **位置**: TestReportTemplateServiceImpl.java:162
- **问题**: 删除模板前未检查是否有报告使用此模板
- **影响**: 可能误删正在使用的模板
- **代码片段**:
```java
// TODO: 检查是否有报告使用此模板
```

## 四、Python服务层未完整实现

### 1. UI脚本生成服务 - 部分操作未实现
- **位置**: ui_script_generation_service.py:286, 359, 402
- **问题**: 部分操作类型（action_type）的脚本生成逻辑使用TODO占位
- **影响**: 某些操作类型的UI脚本可能无法正确生成
- **代码片段**:
```python
return f"# TODO: {action_type} - {element_desc}"
# TODO: 实现{action_type}操作
```

## 五、前后端对接问题（已修复）

### 1. 测试执行统计接口参数不一致 ✅
- **前端调用**: `startTime` 和 `endTime` (testExecution.ts:201)
- **后端实现**: `startDate` 和 `endDate` (TestExecutionController.java:281)
- **问题**: 参数名称不一致（Time vs Date）
- **影响**: 统计功能的时间范围筛选可能无法正常工作
- **修复**: 已统一为 `startDate` 和 `endDate`，前端API参数已更新

### 2. 用例生成批量接口请求体格式不一致 ✅
- **前端调用**: `CaseGenerationRequest[]` (数组格式) (caseGeneration.ts:38)
- **后端实现**: `BatchCaseGenerationRequest` (对象格式，包含requests数组) (CaseGenerationController.java:40)
- **问题**: 请求体格式不匹配
- **影响**: 批量生成用例功能无法使用
- **修复**: 前端已改为对象格式，包含 `requirementIds` 数组和其他共享参数，返回类型已更新为 `BatchCaseGenerationResult`

## 六、功能模块完整性问题

### 1. 测试执行模块
- **状态**: 后端Controller和Service已实现，前端页面已创建
- **问题**: 
  - API路径不一致（见上述）
  - 缺少实际的脚本执行引擎集成（Selenium/Playwright）
  - 缺少执行结果收集和存储机制
- **影响**: 测试执行功能无法真正执行测试脚本

### 2. 测试报告模块
- **状态**: 后端Service已实现，支持Word/PDF/Excel导出
- **问题**: 
  - 报告模板变量替换逻辑可能不完整
  - 报告生成时缺少数据校验
- **影响**: 生成的报告可能格式不正确或数据缺失

### 3. 测试覆盖分析模块
- **状态**: 后端Service已实现基础功能
- **问题**: 
  - 代码覆盖分析需要外部数据，但缺少数据接入接口
  - 覆盖趋势分析的数据来源不明确
- **影响**: 代码覆盖分析功能无法使用

### 4. 风险评估模块
- **状态**: 后端Service已实现基础功能
- **问题**: 
  - 风险评分算法可能过于简单
  - 缺少风险项识别的AI能力
- **影响**: 风险评估结果可能不够准确

### 5. 规约检查模块
- **状态**: 后端Service已实现基础功能
- **问题**: 
  - 缺少根据ID列表查询规约的方法（见TODO）
  - 规约匹配逻辑可能不够智能
- **影响**: 规约检查功能可能无法完整使用

### 6. UI脚本生成模块
- **状态**: 后端Java和Python服务都已实现
- **问题**: 
  - Python服务中部分操作类型未实现（见TODO）
  - 缺少页面元素智能定位功能
  - 缺少脚本执行验证机制
- **影响**: 某些操作类型的脚本无法生成

### 7. UI脚本修复模块
- **状态**: 后端Java和Python服务都已实现
- **问题**: 
  - 错误分析可能不够深入
  - 页面变化检测算法可能不够准确
- **影响**: 脚本修复成功率可能不高

### 8. 用例生成模块
- **状态**: 后端Java和Python服务都已实现
- **问题**: 
  - 批量生成接口路径和格式不一致（见上述）
  - 缺少生成进度实时推送机制
- **影响**: 批量生成功能无法使用，用户体验不佳

### 9. 知识库模块
- **状态**: 后端Java和Python服务都已实现
- **问题**: 
  - 向量数据库初始化可能不完整
  - 语义检索的准确度可能不够
- **影响**: 知识库检索功能可能效果不佳

### 10. 用例复用模块
- **状态**: 后端Java和Python服务都已实现
- **问题**: 
  - 用例向量化可能不完整
  - 相似度计算算法可能不够准确
- **影响**: 用例复用推荐可能不够精准

## 七、数据模型和业务逻辑问题

### 1. 用户认证和授权
- **问题**: 
  - 代码中有多处TODO标记，需要从SecurityContext获取用户信息
  - 缺少完整的用户认证和授权机制
- **位置**: 
  - LoggingMDCFilter.java:65
  - AuditLogAspect.java:205, 213
- **影响**: 操作日志和审计日志可能无法正确记录用户信息

### 2. 编码生成规则
- **状态**: 大部分实体已实现编码自动生成
- **问题**: 需要确认所有实体都正确实现了编码生成规则
- **影响**: 如果编码生成失败，可能导致数据创建失败

## 八、前端页面实现问题

### 1. 页面组件完整性
- **状态**: 所有页面组件都已创建
- **问题**: 
  - 部分页面可能缺少错误处理
  - 部分页面可能缺少加载状态提示
  - 部分页面可能缺少数据校验
- **影响**: 用户体验不佳，可能出现未处理的错误

### 2. API调用错误处理
- **状态**: 前端API封装已实现
- **问题**: 
  - 部分API调用可能缺少错误处理
  - 部分API调用可能缺少重试机制
- **影响**: 网络错误时用户体验不佳

## 九、数据库和配置问题

### 1. 数据库初始化
- **状态**: 数据库脚本已创建
- **问题**: 
  - 需要确认所有表结构都已创建
  - 需要确认初始数据是否正确
- **影响**: 系统可能无法正常启动或运行

### 2. 配置文件
- **状态**: 配置文件已创建
- **问题**: 
  - 需要确认AI服务URL配置是否正确
  - 需要确认文件上传路径配置是否正确
- **影响**: 系统间调用可能失败，文件上传可能失败

## 十、测试和文档问题

### 1. 单元测试
- **状态**: 部分Controller已有测试类
- **问题**: 
  - 测试覆盖率可能不够
  - 部分Service层可能缺少测试
- **影响**: 代码质量无法保证，可能出现回归问题

### 2. API文档
- **状态**: 使用Swagger注解
- **问题**: 
  - 需要确认所有API都有完整的文档
  - 需要确认API文档与实际实现一致
- **影响**: 前端开发可能无法正确调用API

## 十一、优先级建议

### P0 - 高优先级（必须修复）
1. **API路径不一致问题** - 导致功能完全无法使用
2. **规约检查功能TODO** - 核心功能缺失
3. **用例生成批量接口** - 功能无法使用

### P1 - 中优先级（建议修复）
1. **测试执行统计接口参数不一致**
2. **UI脚本生成部分操作未实现**
3. **流程文档导出功能未实现**

### P2 - 低优先级（可选优化）
1. **数据文档生成AI提取功能**
2. **报告模板删除前检查**
3. **用户认证和授权完善**

## 十二、修复建议

### 1. 统一API路径规范
- 建议：建立API路径规范文档，确保前后端一致
- 方法：使用OpenAPI/Swagger规范，前后端共享API定义

### 2. 完善TODO功能
- 建议：按优先级逐步实现所有TODO功能
- 方法：创建TODO任务清单，分配开发资源

### 3. 加强前后端联调
- 建议：建立前后端联调流程，确保接口对接正确
- 方法：使用Mock数据，进行接口测试

### 4. 完善错误处理
- 建议：统一错误处理机制，提供友好的错误提示
- 方法：使用全局异常处理，统一错误响应格式

### 5. 加强测试覆盖
- 建议：提高单元测试和集成测试覆盖率
- 方法：使用测试驱动开发，确保代码质量

